{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _this = this,\n    _jsxFileName = \"/home/dilip/Desktop/iuvdx-core-old/client/src/components/ipcam-server/IpcamServerComponent.js\";\n\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nfunction getModalStyle() {\n  var top = 50;\n  var left = 50;\n  return {\n    top: \"\".concat(top, \"%\"),\n    left: \"\".concat(left, \"%\"),\n    transform: \"translate(-\".concat(top, \"%, -\").concat(left, \"%)\")\n  };\n}\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      outline: 'none',\n      position: 'absolute',\n      width: 900,\n      backgroundColor: theme.palette.background.paper,\n      padding: theme.spacing(4, 4, 4)\n    },\n    container: {\n      maxHeight: 400\n    },\n    btn: {\n      marginLeft: 30\n    },\n    title: _objectSpread(_objectSpread({\n      display: \"flex\",\n      alignItems: \"center\",\n      padding: theme.spacing(0, 1)\n    }, theme.mixins.toolbar), {}, {\n      justifyContent: \"flex-start\"\n    }),\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 120\n    }\n  };\n}); // assigning unique id for each camera\n\nvar rowId = 4; // contains already connected cameras  \n\nvar connectedCameras = [];\n\nvar IpcamServerComponent = function IpcamServerComponent(props) {\n  var classes = useStyles(); // getModalStyle is not a pure function, we roll the style only on the first render\n\n  var _useState = useState(getModalStyle),\n      _useState2 = _slicedToArray(_useState, 1),\n      modalStyle = _useState2[0]; // newly added cameras will go into tableRows\n\n\n  var _useState3 = useState([{\n    id: 0,\n    ip: 'rtsp://195.46.114.132/live/ch00_0',\n    port: 6000,\n    type: '',\n    url: '',\n    del: false,\n    err: false\n  }, {\n    id: 1,\n    ip: 'rtsp://98.163.61.242/live/ch00_0',\n    port: 6001,\n    type: '',\n    url: '',\n    del: false,\n    err: false\n  }, {\n    id: 2,\n    ip: 'rtsp://91.191.213.49:554/live_mpeg4.sdp',\n    port: 6002,\n    type: '',\n    url: '',\n    del: false,\n    err: false\n  } // {id:3, cam:'Hessdalen', ip:'rtsp://freja.hiof.no:1935/rtplive/definst/hessdalen03.stream', del:false, err:false}\n  ]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tableRows = _useState4[0],\n      setTableRows = _useState4[1]; // deleted cameras is stored in this variable\n\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      deleteCam = _useState6[0],\n      setDeleteCam = _useState6[1];\n\n  var handleClose = function handleClose() {\n    props.setClose();\n  }; // function to handle checkbox onchecked validation\n\n\n  var handleChecked = function handleChecked(idx) {\n    return function (e) {\n      // changes the checked value status\n      var trows = _toConsumableArray(tableRows);\n\n      trows[idx] = {\n        id: trows[idx].id,\n        ip: trows[idx].ip !== '' ? trows[idx].ip : '',\n        port: trows[idx].port !== '' ? trows[idx].port : '',\n        type: trows[idx].type !== '' ? trows[idx].type : '',\n        url: trows[idx].url,\n        del: e.target.checked,\n        err: trows[idx].err\n      };\n      setTableRows(trows); // cameras added to list if the box is checked\n\n      if (e.target.checked) {\n        setDeleteCam([].concat(_toConsumableArray(deleteCam), [tableRows[idx].id]));\n      } else {\n        var index = deleteCam.indexOf(tableRows[idx].id);\n\n        if (index > -1) {\n          deleteCam.splice(index, 1);\n        }\n\n        setDeleteCam(deleteCam);\n      }\n    };\n  }; // disconnects all the selected cameras from the session\n\n\n  var deleteSelectedCam = function deleteSelectedCam() {\n    var camToDelete = []; // validates the cameras that are to be deleted\n\n    var _iterator = _createForOfIteratorHelper(deleteCam),\n        _step;\n\n    try {\n      var _loop = function _loop() {\n        var id = _step.value;\n        var index = tableRows.findIndex(function (val) {\n          return val.id === id;\n        });\n\n        if (tableRows[index].ip !== '' && tableRows[index].port !== '' && tableRows[index].type !== '') {\n          camToDelete.push(tableRows[index].port.toString());\n          var indx = connectedCameras.indexOf(id); // removing cameras from already connected camera list\n\n          if (indx > -1) {\n            connectedCameras.splice(indx, 1);\n          }\n        }\n\n        tableRows.splice(index, 1);\n        setTableRows(tableRows);\n      };\n\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        _loop();\n      } // call for diconnecting the cameras \n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    if (camToDelete.length > 0) {\n      props.removeCam(camToDelete);\n    }\n\n    setDeleteCam([]);\n  }; // establishes connection for the cameras\n\n\n  var connectSelectedCam = function connectSelectedCam() {\n    var camToConnect = []; // adds only the cameras that are not already connected\n\n    var _iterator2 = _createForOfIteratorHelper(tableRows),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var val = _step2.value;\n\n        if (!val.err && !connectedCameras.includes(val.id)) {\n          if (val.ip !== '' && val.port !== '' && val.type !== '') {\n            camToConnect.push(val);\n            connectedCameras.push(val.id);\n          }\n        }\n      } // call for establishing connection\n\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    if (camToConnect.length > 0) {\n      props.getToken(camToConnect, false);\n    }\n\n    var rows = _toConsumableArray(tableRows);\n\n    var _loop2 = function _loop2() {\n      var val = _camToConnect[_i];\n\n      switch (val.type) {\n        case 'rtsptortsp':\n          var index = rows.findIndex(function (obj) {\n            return obj.port === val.port;\n          });\n          rows[index].url = 'rtsp://0.0.0.0:' + val.port + '/stream';\n          console.log(rows[index].url);\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    for (var _i = 0, _camToConnect = camToConnect; _i < _camToConnect.length; _i++) {\n      _loop2();\n    }\n\n    setTableRows(rows);\n  }; // adds new row to the table\n\n\n  var handleAddRow = function handleAddRow() {\n    var item = {\n      id: rowId,\n      ip: '',\n      port: '',\n      type: '',\n      url: '',\n      del: false,\n      err: false\n    };\n    rowId++;\n    setTableRows([].concat(_toConsumableArray(tableRows), [item]));\n  }; // remove all the rows that are empty\n\n\n  var handleRemoveRow = function handleRemoveRow() {\n    var nonEmptyRows = tableRows.filter(function (val) {\n      return val.ip !== '' && val.port !== '';\n    });\n    setTableRows(nonEmptyRows);\n  }; // handle changes while modifying details in the table\n\n\n  var handleChange = function handleChange(idx) {\n    return function (e) {\n      var _e$target = e.target,\n          name = _e$target.name,\n          value = _e$target.value;\n\n      var rows = _toConsumableArray(tableRows); // adds the camera name\n\n\n      if (name === 'ip') {\n        rows[idx] = {\n          id: rows[idx].id,\n          [name]: value,\n          port: rows[idx].port !== '' ? rows[idx].port : '',\n          type: rows[idx].type !== '' ? rows[idx].type : '',\n          url: '',\n          del: rows[idx].del ? true : false,\n          err: rows[idx].err\n        };\n      } else if (name === 'port') {\n        // adds the camera rstp url\n        rows[idx] = {\n          id: rows[idx].id,\n          ip: rows[idx].ip !== '' ? rows[idx].ip : '',\n          [name]: value,\n          type: rows[idx].type !== '' ? rows[idx].type : '',\n          url: '',\n          del: rows[idx].del ? true : false,\n          err: value !== '' && rows.find(function (val) {\n            return val.port === value;\n          })\n        };\n      } else {\n        rows[idx] = {\n          id: rows[idx].id,\n          ip: rows[idx].ip !== '' ? rows[idx].ip : '',\n          port: rows[idx].port !== '' ? rows[idx].port : '',\n          [name]: value,\n          url: '',\n          del: rows[idx].del ? true : false,\n          err: rows[idx].err\n        };\n      }\n\n      setTableRows(rows);\n    };\n  };\n\n  var copyToClipboard = function copyToClipboard(e) {\n    console.log(e.target);\n    document.execCommand(\"copy\"); // Change state to false\n    // this.setState({ copied: !this.state.copied });\n  }; // function to the render dynamic table\n\n\n  var renderTable = function renderTable() {\n    return tableRows.map(function (rows, idx) {\n      return /*#__PURE__*/React.createElement(TableRow, {\n        key: idx,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TextField, {\n        error: tableRows[idx].err ? true : false,\n        label: \"Video url\",\n        name: \"ip\",\n        variant: \"outlined\",\n        value: tableRows[idx].ip,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TextField, {\n        type: \"number\",\n        error: tableRows[idx].err ? true : false,\n        disabled: tableRows[idx].err ? true : false,\n        label: \"Port\",\n        name: \"port\",\n        variant: \"outlined\",\n        helperText: tableRows[idx].err ? 'Duplicate port' : '',\n        value: tableRows[idx].port,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(FormControl, {\n        variant: \"outlined\",\n        className: classes.formControl,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 14\n        }\n      }, /*#__PURE__*/React.createElement(InputLabel, {\n        htmlFor: \"outlined-age-native-simple\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 15\n        }\n      }, \"Server Type\"), /*#__PURE__*/React.createElement(Select, {\n        name: \"type\",\n        label: \"Server Type\",\n        value: tableRows[idx].type,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(MenuItem, {\n        value: \"rtsptortp\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 17\n        }\n      }, \"Rtsp to Rtp\"), /*#__PURE__*/React.createElement(MenuItem, {\n        value: \"rtsptortsp\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 17\n        }\n      }, \"Rtsp to Rtsp\")))), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TextField, {\n        name: \"finalUrl\",\n        value: tableRows[idx].url,\n        InputProps: {\n          readOnly: true\n        },\n        variant: \"filled\",\n        onClick: copyToClipboard(),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Checkbox, {\n        indeterminate: true,\n        inputProps: {\n          'aria-label': 'indeterminate checkbox'\n        },\n        checked: tableRows[idx].del,\n        onChange: handleChecked(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 12\n        }\n      })));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    open: props.open,\n    onClose: handleClose,\n    \"aria-labelledby\": \"simple-modal-title\",\n    \"aria-describedby\": \"simple-modal-description\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: modalStyle,\n    className: classes.paper,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h4\",\n    className: classes.title,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 11\n    }\n  }, \"Create Server\"), /*#__PURE__*/React.createElement(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: connectSelectedCam,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 11\n    }\n  }, \"Connect\"), /*#__PURE__*/React.createElement(Button, {\n    className: classes.btn,\n    variant: \"contained\",\n    color: \"secondary\",\n    onClick: deleteSelectedCam,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 11\n    }\n  }, \"Disconnect\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    className: classes.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"simple table\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 21\n    }\n  }, \"Video Url\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 21\n    }\n  }, \"Service Port\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 21\n    }\n  }, \"Server type \"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 21\n    }\n  }, \"Final Url\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 21\n    }\n  }, \"Remove\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 15\n    }\n  }, renderTable()))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    onClick: handleAddRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 13\n    }\n  }, \"Add Row\"), /*#__PURE__*/React.createElement(Button, {\n    className: classes.btn,\n    variant: \"outlined\",\n    color: \"secondary\",\n    onClick: handleRemoveRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 13\n    }\n  }, \"Delete Empty Rows\"))));\n};\n\nexport default IpcamServerComponent;","map":{"version":3,"sources":["/home/dilip/Desktop/iuvdx-core-old/client/src/components/ipcam-server/IpcamServerComponent.js"],"names":["React","useState","makeStyles","Modal","Button","TextField","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Divider","Typography","Checkbox","InputLabel","FormControl","Select","MenuItem","getModalStyle","top","left","transform","useStyles","theme","paper","outline","position","width","backgroundColor","palette","background","padding","spacing","container","maxHeight","btn","marginLeft","title","display","alignItems","mixins","toolbar","justifyContent","formControl","margin","minWidth","rowId","connectedCameras","IpcamServerComponent","props","classes","modalStyle","id","ip","port","type","url","del","err","tableRows","setTableRows","deleteCam","setDeleteCam","handleClose","setClose","handleChecked","idx","e","trows","target","checked","index","indexOf","splice","deleteSelectedCam","camToDelete","findIndex","val","push","toString","indx","length","removeCam","connectSelectedCam","camToConnect","includes","getToken","rows","obj","console","log","handleAddRow","item","handleRemoveRow","nonEmptyRows","filter","handleChange","name","value","find","copyToClipboard","document","execCommand","renderTable","map","readOnly","open","table"],"mappings":"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","sourcesContent":["import React,{useState} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport Button from '@material-ui/core/Button'\nimport TextField from '@material-ui/core/TextField'\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nfunction getModalStyle() {\n  const top = 50;\n  const left = 50;\n\n  return {\n    top: `${top}%`,\n    left: `${left}%`,\n    transform: `translate(-${top}%, -${left}%)`,\n  };\n}\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    outline: 'none',\n    position: 'absolute',\n    width: 900,\n    backgroundColor: theme.palette.background.paper,\n    padding: theme.spacing(4, 4, 4),\n  },\n  container: {\n    maxHeight: 400,\n  },\n  btn: {\n    marginLeft: 30,\n  },\n  title: {\n    display: \"flex\",\n    alignItems: \"center\",\n    padding: theme.spacing(0, 1), ...theme.mixins.toolbar,\n    justifyContent: \"flex-start\"\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  }\n}));\n\n// assigning unique id for each camera\nlet rowId = 4;\n\n// contains already connected cameras  \nlet connectedCameras = [];\n\nconst IpcamServerComponent =(props) =>{\n\n  const classes = useStyles();\n  // getModalStyle is not a pure function, we roll the style only on the first render\n  const [modalStyle] = useState(getModalStyle);\n\n  // newly added cameras will go into tableRows\n  const [tableRows, setTableRows] = useState([\n    {id:0, ip:'rtsp://195.46.114.132/live/ch00_0', port: 6000, type: '', url:'', del:false, err:false},\n    {id:1, ip:'rtsp://98.163.61.242/live/ch00_0', port: 6001, type: '', url:'', del:false, err:false},\n    {id:2, ip:'rtsp://91.191.213.49:554/live_mpeg4.sdp', port:6002, type: '', url:'', del:false, err:false},\n    // {id:3, cam:'Hessdalen', ip:'rtsp://freja.hiof.no:1935/rtplive/definst/hessdalen03.stream', del:false, err:false}\n  ]);\n\n  // deleted cameras is stored in this variable\n  const [deleteCam, setDeleteCam] = useState([]);\n\n  const handleClose = () => {\n    props.setClose();\n  };\n\n  // function to handle checkbox onchecked validation\n  const handleChecked = (idx) => (e) => {\n\n    // changes the checked value status\n    const trows = [...tableRows];\n    trows[idx] = {\n      id: trows[idx].id,\n      ip: trows[idx].ip !== ''? trows[idx].ip: '',\n      port: trows[idx].port !== ''? trows[idx].port: '',\n      type: trows[idx].type !== ''? trows[idx].type: '',\n      url: trows[idx].url,\n      del: e.target.checked,\n      err: trows[idx].err\n    }\n    setTableRows(trows);\n\n    // cameras added to list if the box is checked\n    if(e.target.checked) {\n      setDeleteCam([...deleteCam, tableRows[idx].id])\n    }\n    else {\n\n      const index = deleteCam.indexOf(tableRows[idx].id);\n      if(index > -1) {\n        deleteCam.splice(index, 1);\n      }\n      setDeleteCam(deleteCam);\n    }\n  }\n\n  // disconnects all the selected cameras from the session\n  const deleteSelectedCam = () => {\n\n    const camToDelete = [];\n    \n    // validates the cameras that are to be deleted\n    for(const id of deleteCam) {\n\n      const index = tableRows.findIndex(val => val.id === id);\n      if(tableRows[index].ip !== '' && tableRows[index].port !== '' && tableRows[index].type !== '') {\n        \n        camToDelete.push(tableRows[index].port.toString());\n        let indx = connectedCameras.indexOf(id);\n\n        // removing cameras from already connected camera list\n        if (indx > -1) {\n          connectedCameras.splice(indx, 1);\n        }\n      }\n      tableRows.splice(index, 1);\n      setTableRows(tableRows);\n    }\n\n    // call for diconnecting the cameras \n    if(camToDelete.length > 0) {\n      props.removeCam(camToDelete);\n    }\n\n    setDeleteCam([]);\n  }\n\n  // establishes connection for the cameras\n  const connectSelectedCam = () => {\n\n    let camToConnect = [];\n\n    // adds only the cameras that are not already connected\n    for(const val of tableRows) {\n      if(!val.err && !connectedCameras.includes(val.id)) {\n        if(val.ip !== '' && val.port !== '' && val.type !== '') {\n          camToConnect.push(val);\n          connectedCameras.push(val.id);\n        }\n      }\n    }\n\n    // call for establishing connection\n    if(camToConnect.length > 0) {\n      props.getToken(camToConnect, false);\n    }\n\n    const rows = [...tableRows];\n\n    for(const val of camToConnect) {\n      switch (val.type) {\n        case 'rtsptortsp':\n          let index = rows.findIndex((obj => obj.port === val.port));\n          rows[index].url = 'rtsp://0.0.0.0:' + val.port + '/stream';\n          console.log(rows[index].url);\n          break;\n        default:\n          break;\n      }\n    }\n\n    setTableRows(rows);\n  }\n\n  // adds new row to the table\n  const handleAddRow = () => {\n    const item = {\n      id   : rowId,\n      ip   : '',\n      port : '',\n      type : '',\n      url  : '',\n      del  : false,\n      err  : false\n    };\n    rowId++;\n    setTableRows([...tableRows, item]);\n  };\n\n  // remove all the rows that are empty\n  const handleRemoveRow = () => {\n    const nonEmptyRows = tableRows.filter(val => val.ip !== '' && val.port !== '');\n    setTableRows(nonEmptyRows)\n  };\n\n  // handle changes while modifying details in the table\n  const handleChange = (idx) => (e) => {\n\n    const { name, value } = e.target;\n    const rows = [...tableRows];\n    \n    // adds the camera name\n    if(name === 'ip') {\n      rows[idx] = {\n        id     : rows[idx].id,\n        [name] : value,\n        port   : rows[idx].port !== ''? rows[idx].port: '',\n        type   : rows[idx].type !== ''? rows[idx].type: '',\n        url    : '',\n        del    : rows[idx].del? true: false,\n        err    : rows[idx].err\n      }\n    }\n    else if(name === 'port') { // adds the camera rstp url\n      rows[idx] = {\n        id     : rows[idx].id,\n        ip     : rows[idx].ip !== ''? rows[idx].ip: '',\n        [name] : value,\n        type   : rows[idx].type !== ''? rows[idx].type: '',\n        url    : '',\n        del    : rows[idx].del? true: false,\n        err    : value !== '' && rows.find(val => val.port === value)\n      }\n    }\n    else {\n      rows[idx] = {\n        id     : rows[idx].id,\n        ip     : rows[idx].ip !== ''? rows[idx].ip: '',\n        port   : rows[idx].port !== ''? rows[idx].port: '',\n        [name] : value,\n        url    : '',\n        del    : rows[idx].del? true: false,\n        err    : rows[idx].err\n      }\n    }\n    setTableRows(rows);\n  };\n\n  const copyToClipboard = (e) => {\n    console.log(e.target);\n    document.execCommand(\"copy\"); \n    // Change state to false\n    // this.setState({ copied: !this.state.copied });\n  }\n\n  // function to the render dynamic table\n  const renderTable = () => {\n    return tableRows.map((rows, idx) => {\n      return (\n        <TableRow key={idx}>\n          \n          <TableCell>\n            <TextField error={tableRows[idx].err? true: false} label=\"Video url\" name=\"ip\" variant=\"outlined\" \n              value={tableRows[idx].ip} onChange={handleChange(idx)}/>\n          </TableCell>\n          <TableCell>\n            <TextField type=\"number\" error={tableRows[idx].err? true: false} disabled={tableRows[idx].err? true: false} \n            label=\"Port\" name=\"port\" variant=\"outlined\" helperText={tableRows[idx].err?'Duplicate port':''} \n              value={tableRows[idx].port} onChange={handleChange(idx)}/>\n          </TableCell>\n          <TableCell>\n             <FormControl variant=\"outlined\" className={classes.formControl}>\n              <InputLabel htmlFor=\"outlined-age-native-simple\">Server Type</InputLabel>\n              <Select\n                name=\"type\"\n                label=\"Server Type\"\n                value={tableRows[idx].type}\n                onChange={handleChange(idx)}\n              >\n                <MenuItem value={\"rtsptortp\"}>Rtsp to Rtp</MenuItem>\n                <MenuItem value={\"rtsptortsp\"}>Rtsp to Rtsp</MenuItem>\n              </Select>\n            </FormControl> \n          </TableCell>\n          <TableCell>\n            <TextField\n              name=\"finalUrl\"\n              value={tableRows[idx].url}\n              InputProps={{\n                readOnly: true,\n              }}\n              variant=\"filled\"\n              onClick={copyToClipboard()}\n            />\n            </TableCell>\n          <TableCell>\n           <Checkbox  indeterminate inputProps={{ 'aria-label': 'indeterminate checkbox' }}  checked={tableRows[idx].del} onChange={handleChecked(idx)}/>\n          </TableCell>\n        </TableRow>\n      )\n    })\n  }\n\n  return (\n    <div>\n      <Modal\n        open={props.open}\n        onClose={handleClose}\n        aria-labelledby=\"simple-modal-title\"\n        aria-describedby=\"simple-modal-description\"\n      >\n       \n        <div style={modalStyle} className={classes.paper}>\n          <Typography variant=\"h4\" className={classes.title} >\n            Create Server\n          </Typography>\n          <Divider />\n          <br/>\n          <Button variant=\"contained\" color=\"primary\" onClick={connectSelectedCam}>\n            Connect\n          </Button>\n          <Button className={classes.btn} variant=\"contained\" color=\"secondary\" onClick={deleteSelectedCam}>\n            Disconnect\n          </Button>\n          <br/>\n          <br/>\n          <TableContainer component={Paper} className={classes.container}>\n            <Table className={classes.table} aria-label=\"simple table\">\n                {/* <colgroup>\n                    <col style={{width:'50%'}}/>\n                    <col style={{width:'20%'}}/>\n                    <col style={{width:'25%'}}/>\n                </colgroup> */}\n                <TableHead>\n                    <TableRow>\n                    <TableCell>Video Url</TableCell>\n                    <TableCell>Service Port</TableCell>\n                    <TableCell>Server type </TableCell>\n                    <TableCell>Final Url</TableCell>\n                    <TableCell>Remove</TableCell>\n                    </TableRow>\n                </TableHead>\n              <TableBody>\n                {renderTable()}\n              </TableBody>\n            </Table>\n          </TableContainer>\n            <br/>\n            <Button variant=\"outlined\" color=\"primary\" onClick={handleAddRow}>\n              Add Row\n            </Button>\n            <Button className={classes.btn} variant=\"outlined\" color=\"secondary\" onClick={handleRemoveRow}>\n              Delete Empty Rows\n            </Button>\n        </div>\n      </Modal>\n    </div>\n  );\n}\nexport default IpcamServerComponent;"]},"metadata":{},"sourceType":"module"}