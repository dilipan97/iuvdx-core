{"ast":null,"code":"import _classCallCheck from\"/home/dilip/Desktop/iuvdx-core/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/dilip/Desktop/iuvdx-core/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import $ from'jquery';var OpenViduLayout=/*#__PURE__*/function(){function OpenViduLayout(){_classCallCheck(this,OpenViduLayout);}_createClass(OpenViduLayout,[{key:\"fixAspectRatio\",value:function fixAspectRatio(elem,width){var sub=elem.querySelector('.OT_root');if(sub){// If this is the parent of a subscriber or publisher then we need\n// to force the mutation observer on the publisher or subscriber to\n// trigger to get it to fix it's layout\nvar oldWidth=sub.style.width;sub.style.width=width+'px';// sub.style.height = height + 'px';\nsub.style.width=oldWidth||'';}}},{key:\"positionElement\",value:function positionElement(elem,x,y,width,height,animate){var _this=this;var targetPosition={left:x+'px',top:y+'px',width:width+'px',height:height+'px'};this.fixAspectRatio(elem,width);if(animate&&$){$(elem).stop();$(elem).animate(targetPosition,animate.duration||200,animate.easing||'swing',function(){_this.fixAspectRatio(elem,width);if(animate.complete){animate.complete.call(_this);}});}else{$(elem).css(targetPosition);}this.fixAspectRatio(elem,width);}},{key:\"getVideoRatio\",value:function getVideoRatio(elem){if(!elem){return 3/4;}var video=elem.querySelector('video');if(video&&video.videoHeight&&video.videoWidth){return video.videoHeight/video.videoWidth;}else if(elem.videoHeight&&elem.videoWidth){return elem.videoHeight/elem.videoWidth;}return 3/4;}},{key:\"getCSSNumber\",value:function getCSSNumber(elem,prop){var cssStr=$(elem).css(prop);return cssStr?parseInt(cssStr,10):0;}// Really cheap UUID function\n},{key:\"cheapUUID\",value:function cheapUUID(){return(Math.random()*100000000).toFixed(0);}},{key:\"getHeight\",value:function getHeight(elem){var heightStr=$(elem).css('height');return heightStr?parseInt(heightStr,10):0;}},{key:\"getWidth\",value:function getWidth(elem){var widthStr=$(elem).css('width');return widthStr?parseInt(widthStr,10):0;}},{key:\"getBestDimensions\",value:function getBestDimensions(minR,maxR,count,WIDTH,HEIGHT,targetHeight){var maxArea,targetCols,targetRows,targetWidth,tWidth,tHeight,tRatio;// Iterate through every possible combination of rows and columns\n// and see which one has the least amount of whitespace\nfor(var i=1;i<=count;i++){var colsAux=i;var rowsAux=Math.ceil(count/colsAux);// Try taking up the whole height and width\ntHeight=Math.floor(HEIGHT/rowsAux);tWidth=Math.floor(WIDTH/colsAux);tRatio=tHeight/tWidth;if(tRatio>maxR){// We went over decrease the height\ntRatio=maxR;tHeight=tWidth*tRatio;}else if(tRatio<minR){// We went under decrease the width\ntRatio=minR;tWidth=tHeight/tRatio;}var area=tWidth*tHeight*count;// If this width and height takes up the most space then we're going with that\nif(maxArea===undefined||area>maxArea){maxArea=area;targetHeight=tHeight;targetWidth=tWidth;targetCols=colsAux;targetRows=rowsAux;}}return{maxArea:maxArea,targetCols:targetCols,targetRows:targetRows,targetHeight:targetHeight,targetWidth:targetWidth,ratio:targetHeight/targetWidth};}},{key:\"arrange\",value:function arrange(children,WIDTH,HEIGHT,offsetLeft,offsetTop,fixedRatio,minRatio,maxRatio,animate){var targetHeight;var count=children.length;var dimensions;if(!fixedRatio){dimensions=this.getBestDimensions(minRatio,maxRatio,count,WIDTH,HEIGHT,targetHeight);}else{// Use the ratio of the first video element we find to approximate\nvar ratio=this.getVideoRatio(children.length>0?children[0]:null);dimensions=this.getBestDimensions(ratio,ratio,count,WIDTH,HEIGHT,targetHeight);}// Loop through each stream in the container and place it inside\nvar x=0,y=0;var rows=[];var row;// Iterate through the children and create an array with a new item for each row\n// and calculate the width of each row so that we know if we go over the size and need\n// to adjust\nfor(var i=0;i<children.length;i++){if(i%dimensions.targetCols===0){// This is a new row\nrow={children:[],width:0,height:0};rows.push(row);}var elem=children[i];row.children.push(elem);var targetWidth=dimensions.targetWidth;targetHeight=dimensions.targetHeight;// If we're using a fixedRatio then we need to set the correct ratio for this element\nif(fixedRatio){targetWidth=targetHeight/this.getVideoRatio(elem);}row.width+=targetWidth;row.height=targetHeight;}// Calculate total row height adjusting if we go too wide\nvar totalRowHeight=0;var remainingShortRows=0;for(var _i=0;_i<rows.length;_i++){row=rows[_i];if(row.width>WIDTH){// Went over on the width, need to adjust the height proportionally\nrow.height=Math.floor(row.height*(WIDTH/row.width));row.width=WIDTH;}else if(row.width<WIDTH){remainingShortRows+=1;}totalRowHeight+=row.height;}if(totalRowHeight<HEIGHT&&remainingShortRows>0){// We can grow some of the rows, we're not taking up the whole height\nvar remainingHeightDiff=HEIGHT-totalRowHeight;totalRowHeight=0;for(var _i2=0;_i2<rows.length;_i2++){row=rows[_i2];if(row.width<WIDTH){// Evenly distribute the extra height between the short rows\nvar extraHeight=remainingHeightDiff/remainingShortRows;if(extraHeight/row.height>(WIDTH-row.width)/row.width){// We can't go that big or we'll go too wide\nextraHeight=Math.floor((WIDTH-row.width)/row.width*row.height);}row.width+=Math.floor(extraHeight/row.height*row.width);row.height+=extraHeight;remainingHeightDiff-=extraHeight;remainingShortRows-=1;}totalRowHeight+=row.height;}}// vertical centering\ny=(HEIGHT-totalRowHeight)/2;// Iterate through each row and place each child\nfor(var _i3=0;_i3<rows.length;_i3++){row=rows[_i3];// center the row\nvar rowMarginLeft=(WIDTH-row.width)/2;x=rowMarginLeft;for(var j=0;j<row.children.length;j++){var _elem=row.children[j];var _targetWidth=dimensions.targetWidth;targetHeight=row.height;// If we're using a fixedRatio then we need to set the correct ratio for this element\nif(fixedRatio){_targetWidth=Math.floor(targetHeight/this.getVideoRatio(_elem));}_elem.style.position='absolute';// $(elem).css('position', 'absolute');\nvar actualWidth=_targetWidth-this.getCSSNumber(_elem,'paddingLeft')-this.getCSSNumber(_elem,'paddingRight')-this.getCSSNumber(_elem,'marginLeft')-this.getCSSNumber(_elem,'marginRight')-this.getCSSNumber(_elem,'borderLeft')-this.getCSSNumber(_elem,'borderRight');var actualHeight=targetHeight-this.getCSSNumber(_elem,'paddingTop')-this.getCSSNumber(_elem,'paddingBottom')-this.getCSSNumber(_elem,'marginTop')-this.getCSSNumber(_elem,'marginBottom')-this.getCSSNumber(_elem,'borderTop')-this.getCSSNumber(_elem,'borderBottom');this.positionElement(_elem,x+offsetLeft,y+offsetTop,actualWidth,actualHeight,animate);x+=_targetWidth;}y+=targetHeight;}}},{key:\"filterDisplayNone\",value:function filterDisplayNone(element){return element.style.display!=='none';}},{key:\"updateLayout\",value:function updateLayout(){if(this.layoutContainer.style.display==='none'){return;}var id=this.layoutContainer.id;if(!id){id='OT_'+this.cheapUUID();this.layoutContainer.id=id;}var HEIGHT=this.getHeight(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,'borderTop')-this.getCSSNumber(this.layoutContainer,'borderBottom');var WIDTH=this.getWidth(this.layoutContainer)-this.getCSSNumber(this.layoutContainer,'borderLeft')-this.getCSSNumber(this.layoutContainer,'borderRight');var availableRatio=HEIGHT/WIDTH;var offsetLeft=0;var offsetTop=0;var bigOffsetTop=0;var bigOffsetLeft=0;var bigOnes=Array.prototype.filter.call(this.layoutContainer.querySelectorAll('#'+id+'>.'+this.opts.bigClass),this.filterDisplayNone);var smallOnes=Array.prototype.filter.call(this.layoutContainer.querySelectorAll('#'+id+'>*:not(.'+this.opts.bigClass+')'),this.filterDisplayNone);if(bigOnes.length>0&&smallOnes.length>0){var bigWidth,bigHeight;if(availableRatio>this.getVideoRatio(bigOnes[0])){// We are tall, going to take up the whole width and arrange small\n// guys at the bottom\nbigWidth=WIDTH;bigHeight=Math.floor(HEIGHT*this.opts.bigPercentage);offsetTop=bigHeight;bigOffsetTop=HEIGHT-offsetTop;}else{// We are wide, going to take up the whole height and arrange the small\n// guys on the right\nbigHeight=HEIGHT;bigWidth=Math.floor(WIDTH*this.opts.bigPercentage);offsetLeft=bigWidth;bigOffsetLeft=WIDTH-offsetLeft;}if(this.opts.bigFirst){this.arrange(bigOnes,bigWidth,bigHeight,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate);this.arrange(smallOnes,WIDTH-offsetLeft,HEIGHT-offsetTop,offsetLeft,offsetTop,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate);}else{this.arrange(smallOnes,WIDTH-offsetLeft,HEIGHT-offsetTop,0,0,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate);this.arrange(bigOnes,bigWidth,bigHeight,bigOffsetLeft,bigOffsetTop,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate);}}else if(bigOnes.length>0&&smallOnes.length===0){this// We only have one bigOne just center it\n.arrange(bigOnes,WIDTH,HEIGHT,0,0,this.opts.bigFixedRatio,this.opts.bigMinRatio,this.opts.bigMaxRatio,this.opts.animate);}else{this.arrange(smallOnes,WIDTH-offsetLeft,HEIGHT-offsetTop,offsetLeft,offsetTop,this.opts.fixedRatio,this.opts.minRatio,this.opts.maxRatio,this.opts.animate);}}},{key:\"initLayoutContainer\",value:function initLayoutContainer(container,opts){this.opts={maxRatio:opts.maxRatio!=null?opts.maxRatio:3/2,minRatio:opts.minRatio!=null?opts.minRatio:9/16,fixedRatio:opts.fixedRatio!=null?opts.fixedRatio:false,animate:opts.animate!=null?opts.animate:false,bigClass:opts.bigClass!=null?opts.bigClass:'OT_big',bigPercentage:opts.bigPercentage!=null?opts.bigPercentage:0.8,bigFixedRatio:opts.bigFixedRatio!=null?opts.bigFixedRatio:false,bigMaxRatio:opts.bigMaxRatio!=null?opts.bigMaxRatio:3/2,bigMinRatio:opts.bigMinRatio!=null?opts.bigMinRatio:9/16,bigFirst:opts.bigFirst!=null?opts.bigFirst:true};this.layoutContainer=typeof container==='string'?$(container):container;}},{key:\"setLayoutOptions\",value:function setLayoutOptions(options){this.opts=options;}}]);return OpenViduLayout;}();export default OpenViduLayout;","map":{"version":3,"sources":["/home/dilip/Desktop/iuvdx-core/client/src/layout/openvidu-layout.js"],"names":["$","OpenViduLayout","elem","width","sub","querySelector","oldWidth","style","x","y","height","animate","targetPosition","left","top","fixAspectRatio","stop","duration","easing","complete","call","css","video","videoHeight","videoWidth","prop","cssStr","parseInt","Math","random","toFixed","heightStr","widthStr","minR","maxR","count","WIDTH","HEIGHT","targetHeight","maxArea","targetCols","targetRows","targetWidth","tWidth","tHeight","tRatio","i","colsAux","rowsAux","ceil","floor","area","undefined","ratio","children","offsetLeft","offsetTop","fixedRatio","minRatio","maxRatio","length","dimensions","getBestDimensions","getVideoRatio","rows","row","push","totalRowHeight","remainingShortRows","remainingHeightDiff","extraHeight","rowMarginLeft","j","position","actualWidth","getCSSNumber","actualHeight","positionElement","element","display","layoutContainer","id","cheapUUID","getHeight","getWidth","availableRatio","bigOffsetTop","bigOffsetLeft","bigOnes","Array","prototype","filter","querySelectorAll","opts","bigClass","filterDisplayNone","smallOnes","bigWidth","bigHeight","bigPercentage","bigFirst","arrange","bigFixedRatio","bigMinRatio","bigMaxRatio","container","options"],"mappings":"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","sourcesContent":["import $ from 'jquery';\n\nclass OpenViduLayout {\n  layoutContainer;\n  opts ;\n\n  fixAspectRatio(elem, width) {\n    const sub = elem.querySelector('.OT_root');\n    if (sub) {\n      // If this is the parent of a subscriber or publisher then we need\n      // to force the mutation observer on the publisher or subscriber to\n      // trigger to get it to fix it's layout\n      const oldWidth = sub.style.width;\n      sub.style.width = width + 'px';\n      // sub.style.height = height + 'px';\n      sub.style.width = oldWidth || '';\n    }\n  }\n\n positionElement(elem, x, y, width, height, animate) {\n    const targetPosition = {\n      left: x + 'px',\n      top: y + 'px',\n      width: width + 'px',\n      height: height + 'px',\n    };\n\n    this.fixAspectRatio(elem, width);\n\n    if (animate && $) {\n      $(elem).stop();\n      $(elem).animate(targetPosition, animate.duration || 200, animate.easing || 'swing', () => {\n        this.fixAspectRatio(elem, width);\n        if (animate.complete) {\n          animate.complete.call(this);\n        }\n      });\n    } else {\n      $(elem).css(targetPosition);\n    }\n    this.fixAspectRatio(elem, width);\n  }\n\n  getVideoRatio(elem) {\n    if (!elem) {\n      return 3 / 4;\n    }\n    const video = elem.querySelector('video');\n    if (video && video.videoHeight && video.videoWidth) {\n      return video.videoHeight / video.videoWidth;\n    } else if (elem.videoHeight && elem.videoWidth) {\n      return elem.videoHeight / elem.videoWidth;\n    }\n    return 3 / 4;\n  }\n\n   getCSSNumber(elem, prop) {\n    const cssStr = $(elem).css(prop);\n    return cssStr ? parseInt(cssStr, 10) : 0;\n  }\n\n  // Really cheap UUID function\n   cheapUUID() {\n    return (Math.random() * 100000000).toFixed(0);\n  }\n\n   getHeight(elem) {\n    const heightStr = $(elem).css('height');\n    return heightStr ? parseInt(heightStr, 10) : 0;\n  }\n\n   getWidth(elem) {\n    const widthStr = $(elem).css('width');\n    return widthStr ? parseInt(widthStr, 10) : 0;\n  }\n\n   getBestDimensions(minR , maxR , count , WIDTH, HEIGHT, targetHeight) {\n    let maxArea, targetCols, targetRows, targetWidth, tWidth, tHeight, tRatio;\n\n    // Iterate through every possible combination of rows and columns\n    // and see which one has the least amount of whitespace\n    for (let i = 1; i <= count; i++) {\n      const colsAux = i;\n      const rowsAux = Math.ceil(count / colsAux);\n\n      // Try taking up the whole height and width\n      tHeight = Math.floor(HEIGHT / rowsAux);\n      tWidth = Math.floor(WIDTH / colsAux);\n\n      tRatio = tHeight / tWidth;\n      if (tRatio > maxR) {\n        // We went over decrease the height\n        tRatio = maxR;\n        tHeight = tWidth * tRatio;\n      } else if (tRatio < minR) {\n        // We went under decrease the width\n        tRatio = minR;\n        tWidth = tHeight / tRatio;\n      }\n\n      const area = tWidth * tHeight * count;\n\n      // If this width and height takes up the most space then we're going with that\n      if (maxArea === undefined || area > maxArea) {\n        maxArea = area;\n        targetHeight = tHeight;\n        targetWidth = tWidth;\n        targetCols = colsAux;\n        targetRows = rowsAux;\n      }\n    }\n    return {\n      maxArea: maxArea,\n      targetCols: targetCols,\n      targetRows: targetRows,\n      targetHeight: targetHeight,\n      targetWidth: targetWidth,\n      ratio: targetHeight / targetWidth,\n    };\n  }\n\n   arrange(\n    children,\n    WIDTH,\n    HEIGHT,\n    offsetLeft,\n    offsetTop,\n    fixedRatio,\n    minRatio,\n    maxRatio,\n    animate,\n  ) {\n    let targetHeight;\n\n    const count = children.length;\n    let dimensions;\n\n    if (!fixedRatio) {\n      dimensions = this.getBestDimensions(minRatio, maxRatio, count, WIDTH, HEIGHT, targetHeight);\n    } else {\n      // Use the ratio of the first video element we find to approximate\n      const ratio = this.getVideoRatio(children.length > 0 ? children[0] : null);\n      dimensions = this.getBestDimensions(ratio, ratio, count, WIDTH, HEIGHT, targetHeight);\n    }\n\n    // Loop through each stream in the container and place it inside\n    let x = 0,\n      y = 0;\n    const rows = [];\n    let row;\n    // Iterate through the children and create an array with a new item for each row\n    // and calculate the width of each row so that we know if we go over the size and need\n    // to adjust\n    for (let i = 0; i < children.length; i++) {\n      if (i % dimensions.targetCols === 0) {\n        // This is a new row\n        row = {\n          children: [],\n          width: 0,\n          height: 0,\n        };\n        rows.push(row);\n      }\n      const elem = children[i];\n      row.children.push(elem);\n      let targetWidth = dimensions.targetWidth;\n      targetHeight = dimensions.targetHeight;\n      // If we're using a fixedRatio then we need to set the correct ratio for this element\n      if (fixedRatio) {\n        targetWidth = targetHeight / this.getVideoRatio(elem);\n      }\n      row.width += targetWidth;\n      row.height = targetHeight;\n    }\n    // Calculate total row height adjusting if we go too wide\n    let totalRowHeight = 0;\n    let remainingShortRows = 0;\n    for (let i = 0; i < rows.length; i++) {\n      row = rows[i];\n      if (row.width > WIDTH) {\n        // Went over on the width, need to adjust the height proportionally\n        row.height = Math.floor(row.height * (WIDTH / row.width));\n        row.width = WIDTH;\n      } else if (row.width < WIDTH) {\n        remainingShortRows += 1;\n      }\n      totalRowHeight += row.height;\n    }\n    if (totalRowHeight < HEIGHT && remainingShortRows > 0) {\n      // We can grow some of the rows, we're not taking up the whole height\n      let remainingHeightDiff = HEIGHT - totalRowHeight;\n      totalRowHeight = 0;\n      for (let i = 0; i < rows.length; i++) {\n        row = rows[i];\n        if (row.width < WIDTH) {\n          // Evenly distribute the extra height between the short rows\n          let extraHeight = remainingHeightDiff / remainingShortRows;\n          if (extraHeight / row.height > (WIDTH - row.width) / row.width) {\n            // We can't go that big or we'll go too wide\n            extraHeight = Math.floor((WIDTH - row.width) / row.width * row.height);\n          }\n          row.width += Math.floor(extraHeight / row.height * row.width);\n          row.height += extraHeight;\n          remainingHeightDiff -= extraHeight;\n          remainingShortRows -= 1;\n        }\n        totalRowHeight += row.height;\n      }\n    }\n    // vertical centering\n    y = (HEIGHT - totalRowHeight) / 2;\n    // Iterate through each row and place each child\n    for (let i = 0; i < rows.length; i++) {\n      row = rows[i];\n      // center the row\n      const rowMarginLeft = (WIDTH - row.width) / 2;\n      x = rowMarginLeft;\n      for (let j = 0; j < row.children.length; j++) {\n        const elem = row.children[j];\n\n        let targetWidth = dimensions.targetWidth;\n        targetHeight = row.height;\n        // If we're using a fixedRatio then we need to set the correct ratio for this element\n        if (fixedRatio) {\n          targetWidth = Math.floor(targetHeight / this.getVideoRatio(elem));\n        }\n        elem.style.position = 'absolute';\n        // $(elem).css('position', 'absolute');\n        const actualWidth =\n          targetWidth -\n          this.getCSSNumber(elem, 'paddingLeft') -\n          this.getCSSNumber(elem, 'paddingRight') -\n          this.getCSSNumber(elem, 'marginLeft') -\n          this.getCSSNumber(elem, 'marginRight') -\n          this.getCSSNumber(elem, 'borderLeft') -\n          this.getCSSNumber(elem, 'borderRight');\n\n        const actualHeight =\n          targetHeight -\n          this.getCSSNumber(elem, 'paddingTop') -\n          this.getCSSNumber(elem, 'paddingBottom') -\n          this.getCSSNumber(elem, 'marginTop') -\n          this.getCSSNumber(elem, 'marginBottom') -\n          this.getCSSNumber(elem, 'borderTop') -\n          this.getCSSNumber(elem, 'borderBottom');\n\n        this.positionElement(elem, x + offsetLeft, y + offsetTop, actualWidth, actualHeight, animate);\n        x += targetWidth;\n      }\n      y += targetHeight;\n    }\n  }\n\n filterDisplayNone(element) {\n    return element.style.display !== 'none';\n  }\n\n  updateLayout() {\n    if (this.layoutContainer.style.display === 'none') {\n      return;\n    }\n    let id = this.layoutContainer.id;\n    if (!id) {\n      id = 'OT_' + this.cheapUUID();\n      this.layoutContainer.id = id;\n    }\n\n    const HEIGHT =\n      this.getHeight(this.layoutContainer) -\n      this.getCSSNumber(this.layoutContainer, 'borderTop') -\n      this.getCSSNumber(this.layoutContainer, 'borderBottom');\n    const WIDTH =\n      this.getWidth(this.layoutContainer) -\n      this.getCSSNumber(this.layoutContainer, 'borderLeft') -\n      this.getCSSNumber(this.layoutContainer, 'borderRight');\n\n    const availableRatio = HEIGHT / WIDTH;\n\n    let offsetLeft = 0;\n    let offsetTop = 0;\n    let bigOffsetTop = 0;\n    let bigOffsetLeft = 0;\n\n    const bigOnes = Array.prototype.filter.call(\n      this.layoutContainer.querySelectorAll('#' + id + '>.' + this.opts.bigClass),\n      this.filterDisplayNone,\n    );\n    const smallOnes = Array.prototype.filter.call(\n      this.layoutContainer.querySelectorAll('#' + id + '>*:not(.' + this.opts.bigClass + ')'),\n      this.filterDisplayNone,\n    );\n\n    if (bigOnes.length > 0 && smallOnes.length > 0) {\n      let bigWidth, bigHeight;\n\n      if (availableRatio > this.getVideoRatio(bigOnes[0])) {\n        // We are tall, going to take up the whole width and arrange small\n        // guys at the bottom\n        bigWidth = WIDTH;\n        bigHeight = Math.floor(HEIGHT * this.opts.bigPercentage);\n        offsetTop = bigHeight;\n        bigOffsetTop = HEIGHT - offsetTop;\n      } else {\n        // We are wide, going to take up the whole height and arrange the small\n        // guys on the right\n        bigHeight = HEIGHT;\n        bigWidth = Math.floor(WIDTH * this.opts.bigPercentage);\n        offsetLeft = bigWidth;\n        bigOffsetLeft = WIDTH - offsetLeft;\n      }\n      if (this.opts.bigFirst) {\n        this.arrange(\n          bigOnes,\n          bigWidth,\n          bigHeight,\n          0,\n          0,\n          this.opts.bigFixedRatio,\n          this.opts.bigMinRatio,\n          this.opts.bigMaxRatio,\n          this.opts.animate,\n        );\n        this.arrange(\n          smallOnes,\n          WIDTH - offsetLeft,\n          HEIGHT - offsetTop,\n          offsetLeft,\n          offsetTop,\n          this.opts.fixedRatio,\n          this.opts.minRatio,\n          this.opts.maxRatio,\n          this.opts.animate,\n        );\n      } else {\n        this.arrange(\n          smallOnes,\n          WIDTH - offsetLeft,\n          HEIGHT - offsetTop,\n          0,\n          0,\n          this.opts.fixedRatio,\n          this.opts.minRatio,\n          this.opts.maxRatio,\n          this.opts.animate,\n        );\n        this.arrange(\n          bigOnes,\n          bigWidth,\n          bigHeight,\n          bigOffsetLeft,\n          bigOffsetTop,\n          this.opts.bigFixedRatio,\n          this.opts.bigMinRatio,\n          this.opts.bigMaxRatio,\n          this.opts.animate,\n        );\n      }\n    } else if (bigOnes.length > 0 && smallOnes.length === 0) {\n      this\n        // We only have one bigOne just center it\n        .arrange(\n          bigOnes,\n          WIDTH,\n          HEIGHT,\n          0,\n          0,\n          this.opts.bigFixedRatio,\n          this.opts.bigMinRatio,\n          this.opts.bigMaxRatio,\n          this.opts.animate,\n        );\n    } else {\n      this.arrange(\n        smallOnes,\n        WIDTH - offsetLeft,\n        HEIGHT - offsetTop,\n        offsetLeft,\n        offsetTop,\n        this.opts.fixedRatio,\n        this.opts.minRatio,\n        this.opts.maxRatio,\n        this.opts.animate,\n      );\n    }\n  }\n\n  initLayoutContainer(container, opts) {\n    this.opts = {\n      maxRatio: opts.maxRatio != null ? opts.maxRatio : 3 / 2,\n      minRatio: opts.minRatio != null ? opts.minRatio : 9 / 16,\n      fixedRatio: opts.fixedRatio != null ? opts.fixedRatio : false,\n      animate: opts.animate != null ? opts.animate : false,\n      bigClass: opts.bigClass != null ? opts.bigClass : 'OT_big',\n      bigPercentage: opts.bigPercentage != null ? opts.bigPercentage : 0.8,\n      bigFixedRatio: opts.bigFixedRatio != null ? opts.bigFixedRatio : false,\n      bigMaxRatio: opts.bigMaxRatio != null ? opts.bigMaxRatio : 3 / 2,\n      bigMinRatio: opts.bigMinRatio != null ? opts.bigMinRatio : 9 / 16,\n      bigFirst: opts.bigFirst != null ? opts.bigFirst : true,\n    };\n    this.layoutContainer = typeof container === 'string' ? $(container) : container;\n  }\n\n  setLayoutOptions(options) {\n    this.opts = options;\n  }\n}\nexport default OpenViduLayout;\n"]},"metadata":{},"sourceType":"module"}