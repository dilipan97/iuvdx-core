{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/home/dilip/Desktop/iuvdx-core-old/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _this = this,\n    _jsxFileName = \"/home/dilip/Desktop/iuvdx-core-old/client/src/components/ipcam-server/IpcamServerComponent.js\";\n\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nfunction getModalStyle() {\n  var top = 50;\n  var left = 50;\n  return {\n    top: \"\".concat(top, \"%\"),\n    left: \"\".concat(left, \"%\"),\n    transform: \"translate(-\".concat(top, \"%, -\").concat(left, \"%)\")\n  };\n}\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      outline: 'none',\n      position: 'absolute',\n      width: 700,\n      backgroundColor: theme.palette.background.paper,\n      padding: theme.spacing(4, 4, 4)\n    },\n    container: {\n      maxHeight: 400\n    },\n    btn: {\n      marginLeft: 30\n    },\n    title: _objectSpread(_objectSpread({\n      display: \"flex\",\n      alignItems: \"center\",\n      padding: theme.spacing(0, 1)\n    }, theme.mixins.toolbar), {}, {\n      justifyContent: \"flex-start\"\n    }),\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 120\n    }\n  };\n}); // assigning unique id for each camera\n\nvar rowId = 4; // contains already connected cameras  \n\nvar connectedCameras = [];\n\nvar IpcamServerComponent = function IpcamServerComponent(props) {\n  var classes = useStyles(); // getModalStyle is not a pure function, we roll the style only on the first render\n\n  var _useState = useState(getModalStyle),\n      _useState2 = _slicedToArray(_useState, 1),\n      modalStyle = _useState2[0]; // newly added cameras will go into tableRows\n\n\n  var _useState3 = useState([{\n    id: 0,\n    ip: 'rtsp://195.46.114.132/live/ch00_0',\n    port: 6000,\n    type: '',\n    del: false,\n    err: false\n  }, {\n    id: 1,\n    ip: 'rtsp://98.163.61.242/live/ch00_0',\n    port: 6001,\n    type: '',\n    del: false,\n    err: false\n  }, {\n    id: 2,\n    ip: 'rtsp://91.191.213.49:554/live_mpeg4.sdp',\n    port: 6002,\n    type: '',\n    del: false,\n    err: false\n  } // {id:3, cam:'Hessdalen', ip:'rtsp://freja.hiof.no:1935/rtplive/definst/hessdalen03.stream', del:false, err:false}\n  ]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tableRows = _useState4[0],\n      setTableRows = _useState4[1]; // deleted cameras is stored in this variable\n\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      deleteCam = _useState6[0],\n      setDeleteCam = _useState6[1];\n\n  var handleClose = function handleClose() {\n    props.setClose();\n  }; // function to handle checkbox onchecked validation\n\n\n  var handleChecked = function handleChecked(idx) {\n    return function (e) {\n      // changes the checked value status\n      var trows = _toConsumableArray(tableRows);\n\n      trows[idx] = {\n        id: trows[idx].id,\n        ip: trows[idx].ip !== '' ? trows[idx].ip : '',\n        port: trows[idx].port !== '' ? trows[idx].port : '',\n        type: trows[idx].type !== '' ? trows[idx].type : '',\n        del: e.target.checked,\n        err: trows[idx].err\n      };\n      setTableRows(trows); // cameras added to list if the box is checked\n\n      if (e.target.checked) {\n        setDeleteCam([].concat(_toConsumableArray(deleteCam), [tableRows[idx].id]));\n      } else {\n        var index = deleteCam.indexOf(tableRows[idx].id);\n\n        if (index > -1) {\n          deleteCam.splice(index, 1);\n        }\n\n        setDeleteCam(deleteCam);\n      }\n    };\n  }; // disconnects all the selected cameras from the session\n\n\n  var deleteSelectedCam = function deleteSelectedCam() {\n    var camToDelete = []; // validates the cameras that are to be deleted\n\n    var _iterator = _createForOfIteratorHelper(deleteCam),\n        _step;\n\n    try {\n      var _loop = function _loop() {\n        var id = _step.value;\n        var index = tableRows.findIndex(function (val) {\n          return val.id === id;\n        });\n\n        if (tableRows[index].ip !== '' && tableRows[index].port !== '' && tableRows[index].type !== '') {\n          camToDelete.push(tableRows[index].port);\n          var indx = connectedCameras.indexOf(id); // removing cameras from already connected camera list\n\n          if (indx > -1) {\n            connectedCameras.splice(indx, 1);\n          }\n        }\n\n        tableRows.splice(index, 1);\n        setTableRows(tableRows);\n      };\n\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        _loop();\n      } // call for diconnecting the cameras \n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    if (camToDelete.length > 0) {\n      props.removeCam(camToDelete);\n    }\n\n    setDeleteCam([]);\n  }; // establishes connection for the cameras\n\n\n  var connectSelectedCam = function connectSelectedCam() {\n    var camToConnect = []; // adds only the cameras that are not already connected\n\n    var _iterator2 = _createForOfIteratorHelper(tableRows),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var val = _step2.value;\n\n        if (!val.err && !connectedCameras.includes(val.id)) {\n          if (val.ip !== '' && val.port !== '' && val.type !== '') {\n            camToConnect.push(val);\n            connectedCameras.push(val.id);\n          }\n        }\n      } // call for establishing connection\n\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    if (camToConnect.length > 0) {\n      props.getToken(camToConnect);\n    }\n  }; // adds new row to the table\n\n\n  var handleAddRow = function handleAddRow() {\n    var item = {\n      id: rowId,\n      ip: '',\n      port: '',\n      type: '',\n      del: false,\n      err: false\n    };\n    rowId++;\n    setTableRows([].concat(_toConsumableArray(tableRows), [item]));\n  }; // remove all the rows that are empty\n\n\n  var handleRemoveRow = function handleRemoveRow() {\n    var nonEmptyRows = tableRows.filter(function (val) {\n      return val.ip !== '' && val.port !== '';\n    });\n    setTableRows(nonEmptyRows);\n  }; // handle changes while modifying details in the table\n\n\n  var handleChange = function handleChange(idx) {\n    return function (e) {\n      var _e$target = e.target,\n          name = _e$target.name,\n          value = _e$target.value;\n\n      var rows = _toConsumableArray(tableRows); // adds the camera name\n\n\n      if (name === 'ip') {\n        rows[idx] = {\n          id: rows[idx].id,\n          [name]: value,\n          port: rows[idx].port !== '' ? rows[idx].port : '',\n          type: rows[idx].type !== '' ? rows[idx].type : '',\n          del: rows[idx].del ? true : false,\n          err: rows[idx].err\n        };\n      } else if (name === 'port') {\n        // adds the camera rstp url\n        rows[idx] = {\n          id: rows[idx].id,\n          ip: rows[idx].ip !== '' ? rows[idx].ip : '',\n          [name]: value,\n          type: rows[idx].type !== '' ? rows[idx].type : '',\n          del: rows[idx].del ? true : false,\n          err: value !== '' && rows.find(function (val) {\n            return val.port === value;\n          })\n        };\n      } else {\n        rows[idx] = {\n          id: rows[idx].id,\n          ip: rows[idx].ip !== '' ? rows[idx].ip : '',\n          port: rows[idx].port !== '' ? rows[idx].port : '',\n          [name]: value,\n          del: rows[idx].del ? true : false,\n          err: rows[idx].err\n        };\n      }\n\n      setTableRows(rows);\n    };\n  }; // function to the render dynamic table\n\n\n  var renderTable = function renderTable() {\n    return tableRows.map(function (rows, idx) {\n      return /*#__PURE__*/React.createElement(TableRow, {\n        key: idx,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TextField, {\n        error: tableRows[idx].err ? true : false,\n        label: \"Video url\",\n        name: \"ip\",\n        variant: \"outlined\",\n        value: tableRows[idx].ip,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(TextField, {\n        type: \"number\",\n        InputLabelProps: {\n          shrink: true\n        },\n        error: tableRows[idx].err ? true : false,\n        disabled: tableRows[idx].err ? true : false,\n        label: \"Port\",\n        name: \"port\",\n        variant: \"outlined\",\n        helperText: tableRows[idx].err ? 'Duplicate port' : '',\n        value: tableRows[idx].port,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(FormControl, {\n        variant: \"outlined\",\n        className: classes.formControl,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(InputLabel, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 15\n        }\n      }, \"Server Type\"), /*#__PURE__*/React.createElement(Select, {\n        name: \"type\",\n        value: tableRows[idx].type,\n        onChange: handleChange(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(MenuItem, {\n        value: \"RtspToRtp\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 17\n        }\n      }, \"Rtsp to Rtp\"), /*#__PURE__*/React.createElement(MenuItem, {\n        value: \"RtspToRtsp\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 17\n        }\n      }, \"Rtsp to Rtsp\")))), /*#__PURE__*/React.createElement(TableCell, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Checkbox, {\n        indeterminate: true,\n        inputProps: {\n          'aria-label': 'indeterminate checkbox'\n        },\n        checked: tableRows[idx].del,\n        onChange: handleChecked(idx),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 12\n        }\n      })));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    open: props.open,\n    onClose: handleClose,\n    \"aria-labelledby\": \"simple-modal-title\",\n    \"aria-describedby\": \"simple-modal-description\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: modalStyle,\n    className: classes.paper,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h4\",\n    className: classes.title,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 11\n    }\n  }, \"Subscribe to IP Cameras\"), /*#__PURE__*/React.createElement(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: connectSelectedCam,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 11\n    }\n  }, \"Connect\"), /*#__PURE__*/React.createElement(Button, {\n    className: classes.btn,\n    variant: \"contained\",\n    color: \"secondary\",\n    onClick: deleteSelectedCam,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 11\n    }\n  }, \"Disconnect\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    className: classes.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"simple table\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"colgroup\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"col\", {\n    style: {\n      width: '50%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"col\", {\n    style: {\n      width: '20%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"col\", {\n    style: {\n      width: '25%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(TableHead, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 21\n    }\n  }, \"Video Url\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 21\n    }\n  }, \"Port\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 21\n    }\n  }, \"type\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 21\n    }\n  }, \"Remove\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 15\n    }\n  }, renderTable()))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    onClick: handleAddRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, \"Add Row\"), /*#__PURE__*/React.createElement(Button, {\n    className: classes.btn,\n    variant: \"outlined\",\n    color: \"secondary\",\n    onClick: handleRemoveRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 13\n    }\n  }, \"Delete Empty Rows\"))));\n};\n\nexport default IpcamServerComponent;","map":{"version":3,"sources":["/home/dilip/Desktop/iuvdx-core-old/client/src/components/ipcam-server/IpcamServerComponent.js"],"names":["React","useState","makeStyles","Modal","Button","TextField","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Divider","Typography","Checkbox","InputLabel","FormControl","Select","MenuItem","getModalStyle","top","left","transform","useStyles","theme","paper","outline","position","width","backgroundColor","palette","background","padding","spacing","container","maxHeight","btn","marginLeft","title","display","alignItems","mixins","toolbar","justifyContent","formControl","margin","minWidth","rowId","connectedCameras","IpcamServerComponent","props","classes","modalStyle","id","ip","port","type","del","err","tableRows","setTableRows","deleteCam","setDeleteCam","handleClose","setClose","handleChecked","idx","e","trows","target","checked","index","indexOf","splice","deleteSelectedCam","camToDelete","findIndex","val","push","indx","length","removeCam","connectSelectedCam","camToConnect","includes","getToken","handleAddRow","item","handleRemoveRow","nonEmptyRows","filter","handleChange","name","value","rows","find","renderTable","map","shrink","open","table"],"mappings":"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","sourcesContent":["import React,{useState} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Modal from '@material-ui/core/Modal';\nimport Button from '@material-ui/core/Button'\nimport TextField from '@material-ui/core/TextField'\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nfunction getModalStyle() {\n  const top = 50;\n  const left = 50;\n\n  return {\n    top: `${top}%`,\n    left: `${left}%`,\n    transform: `translate(-${top}%, -${left}%)`,\n  };\n}\n\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    outline: 'none',\n    position: 'absolute',\n    width: 700,\n    backgroundColor: theme.palette.background.paper,\n    padding: theme.spacing(4, 4, 4),\n  },\n  container: {\n    maxHeight: 400,\n  },\n  btn: {\n    marginLeft: 30,\n  },\n  title: {\n    display: \"flex\",\n    alignItems: \"center\",\n    padding: theme.spacing(0, 1), ...theme.mixins.toolbar,\n    justifyContent: \"flex-start\"\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  }\n}));\n\n// assigning unique id for each camera\nlet rowId = 4;\n\n// contains already connected cameras  \nlet connectedCameras = [];\n\nconst IpcamServerComponent =(props) =>{\n\n  const classes = useStyles();\n  // getModalStyle is not a pure function, we roll the style only on the first render\n  const [modalStyle] = useState(getModalStyle);\n\n  // newly added cameras will go into tableRows\n  const [tableRows, setTableRows] = useState([\n    {id:0, ip:'rtsp://195.46.114.132/live/ch00_0', port: 6000, type: '', del:false, err:false},\n    {id:1, ip:'rtsp://98.163.61.242/live/ch00_0', port: 6001, type: '', del:false, err:false},\n    {id:2, ip:'rtsp://91.191.213.49:554/live_mpeg4.sdp', port:6002, type: '', del:false, err:false},\n    // {id:3, cam:'Hessdalen', ip:'rtsp://freja.hiof.no:1935/rtplive/definst/hessdalen03.stream', del:false, err:false}\n  ]);\n\n  // deleted cameras is stored in this variable\n  const [deleteCam, setDeleteCam] = useState([]);\n\n  const handleClose = () => {\n    props.setClose();\n  };\n\n  // function to handle checkbox onchecked validation\n  const handleChecked = (idx) => (e) => {\n\n    // changes the checked value status\n    const trows = [...tableRows];\n    trows[idx] = {\n      id: trows[idx].id,\n      ip: trows[idx].ip !== ''? trows[idx].ip: '',\n      port: trows[idx].port !== ''? trows[idx].port: '',\n      type: trows[idx].type !== ''? trows[idx].type: '',\n      del: e.target.checked,\n      err: trows[idx].err\n    }\n    setTableRows(trows);\n\n    // cameras added to list if the box is checked\n    if(e.target.checked) {\n      setDeleteCam([...deleteCam, tableRows[idx].id])\n    }\n    else {\n\n      const index = deleteCam.indexOf(tableRows[idx].id);\n      if(index > -1) {\n        deleteCam.splice(index, 1);\n      }\n      setDeleteCam(deleteCam);\n    }\n  }\n\n  // disconnects all the selected cameras from the session\n  const deleteSelectedCam = () => {\n\n    const camToDelete = [];\n    \n    // validates the cameras that are to be deleted\n    for(const id of deleteCam) {\n\n      const index = tableRows.findIndex(val => val.id === id);\n      if(tableRows[index].ip !== '' && tableRows[index].port !== '' && tableRows[index].type !== '') {\n        \n        camToDelete.push(tableRows[index].port);\n        let indx = connectedCameras.indexOf(id);\n\n        // removing cameras from already connected camera list\n        if (indx > -1) {\n          connectedCameras.splice(indx, 1);\n        }\n      }\n      tableRows.splice(index, 1);\n      setTableRows(tableRows);\n    }\n\n    // call for diconnecting the cameras \n    if(camToDelete.length > 0) {\n      props.removeCam(camToDelete);\n    }\n\n    setDeleteCam([]);\n  }\n\n  // establishes connection for the cameras\n  const connectSelectedCam = () => {\n\n    let camToConnect = [];\n\n    // adds only the cameras that are not already connected\n    for(const val of tableRows) {\n      if(!val.err && !connectedCameras.includes(val.id)) {\n        if(val.ip !== '' && val.port !== '' && val.type !== '') {\n          camToConnect.push(val);\n          connectedCameras.push(val.id);\n        }\n      }\n    }\n\n    // call for establishing connection\n    if(camToConnect.length > 0) {\n      props.getToken(camToConnect);\n    }\n  }\n\n  // adds new row to the table\n  const handleAddRow = () => {\n    const item = {\n      id   : rowId,\n      ip   : '',\n      port : '',\n      type : '',\n      del  : false,\n      err  : false\n    };\n    rowId++;\n    setTableRows([...tableRows, item]);\n  };\n\n  // remove all the rows that are empty\n  const handleRemoveRow = () => {\n    const nonEmptyRows = tableRows.filter(val => val.ip !== '' && val.port !== '');\n    setTableRows(nonEmptyRows)\n  };\n\n  // handle changes while modifying details in the table\n  const handleChange = (idx) => (e) => {\n\n    const { name, value } = e.target;\n    const rows = [...tableRows];\n    \n    // adds the camera name\n    if(name === 'ip') {\n      rows[idx] = {\n        id     : rows[idx].id,\n        [name] : value,\n        port   : rows[idx].port !== ''? rows[idx].port: '',\n        type   : rows[idx].type !== ''? rows[idx].type: '',\n        del    : rows[idx].del? true: false,\n        err    : rows[idx].err\n      }\n    }\n    else if(name === 'port') { // adds the camera rstp url\n      rows[idx] = {\n        id     : rows[idx].id,\n        ip     : rows[idx].ip !== ''? rows[idx].ip: '',\n        [name] : value,\n        type   : rows[idx].type !== ''? rows[idx].type: '',\n        del    : rows[idx].del? true: false,\n        err    : value !== '' && rows.find(val => val.port === value)\n      }\n    }\n    else {\n      rows[idx] = {\n        id     : rows[idx].id,\n        ip     : rows[idx].ip !== ''? rows[idx].ip: '',\n        port   : rows[idx].port !== ''? rows[idx].port: '',\n        [name] : value,\n        del    : rows[idx].del? true: false,\n        err    : rows[idx].err\n      }\n    }\n    setTableRows(rows);\n  };\n\n  // function to the render dynamic table\n  const renderTable = () => {\n    return tableRows.map((rows, idx) => {\n      return (\n        <TableRow key={idx}>\n          \n          <TableCell>\n            <TextField error={tableRows[idx].err? true: false} label=\"Video url\" name=\"ip\" variant=\"outlined\" \n              value={tableRows[idx].ip} onChange={handleChange(idx)}/>\n          </TableCell>\n          <TableCell>\n            <TextField type=\"number\" InputLabelProps={{ shrink: true }}\n           error={tableRows[idx].err? true: false} disabled={tableRows[idx].err? true: false} \n            label=\"Port\" name=\"port\" variant=\"outlined\" helperText={tableRows[idx].err?'Duplicate port':''} \n              value={tableRows[idx].port} onChange={handleChange(idx)}/>\n          </TableCell>\n          <TableCell>\n            <FormControl variant=\"outlined\" className={classes.formControl}>\n              <InputLabel >Server Type</InputLabel>\n              <Select\n                name=\"type\"\n                value={tableRows[idx].type}\n                onChange={handleChange(idx)}\n              >\n                <MenuItem value={\"RtspToRtp\"}>Rtsp to Rtp</MenuItem>\n                <MenuItem value={\"RtspToRtsp\"}>Rtsp to Rtsp</MenuItem>\n              </Select>\n            </FormControl>\n          </TableCell>\n          <TableCell>\n           <Checkbox  indeterminate inputProps={{ 'aria-label': 'indeterminate checkbox' }}  checked={tableRows[idx].del} onChange={handleChecked(idx)}/>\n          </TableCell>\n        </TableRow>\n      )\n    })\n  }\n\n  return (\n    <div>\n      <Modal\n        open={props.open}\n        onClose={handleClose}\n        aria-labelledby=\"simple-modal-title\"\n        aria-describedby=\"simple-modal-description\"\n      >\n       \n        <div style={modalStyle} className={classes.paper}>\n          <Typography variant=\"h4\" className={classes.title} >\n            Subscribe to IP Cameras\n          </Typography>\n          <Divider />\n          <br/>\n          <Button variant=\"contained\" color=\"primary\" onClick={connectSelectedCam}>\n            Connect\n          </Button>\n          <Button className={classes.btn} variant=\"contained\" color=\"secondary\" onClick={deleteSelectedCam}>\n            Disconnect\n          </Button>\n          <br/>\n          <br/>\n          <TableContainer component={Paper} className={classes.container}>\n            <Table className={classes.table} aria-label=\"simple table\">\n                <colgroup>\n                    <col style={{width:'50%'}}/>\n                    <col style={{width:'20%'}}/>\n                    <col style={{width:'25%'}}/>\n                </colgroup>\n                <TableHead>\n                    <TableRow>\n                    <TableCell>Video Url</TableCell>\n                    <TableCell>Port</TableCell>\n                    <TableCell>type</TableCell>\n                    <TableCell>Remove</TableCell>\n                    </TableRow>\n                </TableHead>\n              <TableBody>\n                {renderTable()}\n              </TableBody>\n            </Table>\n          </TableContainer>\n            <br/>\n            <Button variant=\"outlined\" color=\"primary\" onClick={handleAddRow}>\n              Add Row\n            </Button>\n            <Button className={classes.btn} variant=\"outlined\" color=\"secondary\" onClick={handleRemoveRow}>\n              Delete Empty Rows\n            </Button>\n        </div>\n      </Modal>\n    </div>\n  );\n}\nexport default IpcamServerComponent;"]},"metadata":{},"sourceType":"module"}